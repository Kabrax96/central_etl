2025-07-14 00:14:59,049 - balance_presupuestario_bulk_pipeline - INFO - Starting dynamic bulk pipeline run
2025-07-14 00:15:05,654 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2020 quarter=Q4
2025-07-14 00:15:06,249 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2021 quarter=Q1
2025-07-14 00:15:06,815 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2021 quarter=Q2
2025-07-14 00:15:07,386 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2021 quarter=Q3
2025-07-14 00:15:07,953 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2021 quarter=Q4
2025-07-14 00:15:08,505 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2022 quarter=Q1
2025-07-14 00:15:09,080 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2022 quarter=Q2
2025-07-14 00:15:09,655 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2022 quarter=Q3
2025-07-14 00:15:10,217 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2022 quarter=Q4
2025-07-14 00:15:10,785 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2023 quarter=Q1
2025-07-14 00:15:11,361 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2023 quarter=Q2
2025-07-14 00:15:11,947 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2023 quarter=Q3
2025-07-14 00:15:12,531 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2023 quarter=Q4
2025-07-14 00:15:13,095 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2024 quarter=Q1
2025-07-14 00:15:13,704 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2024 quarter=Q2
2025-07-14 00:15:14,262 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2024 quarter=Q3
2025-07-14 00:15:14,806 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2024 quarter=Q4
2025-07-14 00:15:15,384 - balance_presupuestario_bulk_pipeline - INFO - 100 | Processing year=2025 quarter=Q1
2025-07-14 00:15:16,051 - balance_presupuestario_bulk_pipeline - ERROR - Pipeline run failed. See detailed logs: Bulk load failed: (pg8000.dbapi.IntegrityError) {'S': 'ERROR', 'V': 'ERROR', 'C': '23505', 'M': 'duplicate key value violates unique constraint "nuevo_leon_balance_presupuestario_pkey"', 'D': 'Key (surrogate_key)=(978f2914b0ddc448a48543894094a0d6) already exists.', 's': 'public', 't': 'nuevo_leon_balance_presupuestario', 'n': 'nuevo_leon_balance_presupuestario_pkey', 'F': 'nbtinsert.c', 'L': '670', 'R': '_bt_check_unique'}
[SQL: INSERT INTO nuevo_leon_balance_presupuestario (surrogate_key, concept, sublabel, year_quarter, full_date, type, amount) VALUES (%s::VARCHAR, %s::VARCHAR, %s::VARCHAR, %s::VARCHAR, %s::VARCHAR, %s::VARCHAR, %s::FLOAT)]
[parameters: [('a1119e9c1377bd644fa0a13eceeda018', 'A1', 'Ingresos de Libre Disposición', '2020_Q4', '2020-12-31', 'estimated_or_approved', 60299052.66084), ('1a48628ded7d3b0dfce283cc670e488a', 'A2', 'Transferencias Federales Etiquetadas', '2020_Q4', '2020-12-31', 'estimated_or_approved', 36814210.92416), ('6f83b04d2a17c62eaa45dca5ee771ea2', 'A3', 'Financiamiento Neto', '2020_Q4', '2020-12-31', 'estimated_or_approved', 2291643.5083899996), ('f1f774742fd00971043160a0c8f90131', 'B1', 'Gasto No Etiquetado (sin incluir Amortización de la Deuda Pública)', '2020_Q4', '2020-12-31', 'estimated_or_approved', 64168926.71757992), ('a67243786fb6e3e6e748358a7c603e04', 'B2', 'Gasto Etiquetado (sin incluir Amortización de la Deuda Pública) ', '2020_Q4', '2020-12-31', 'estimated_or_approved', 37372707.77522), ('26b2f1db184531527c1c0ed46c42ea35', 'C1', 'Remanentes de Ingresos de Libre Disposición aplicados en el periodo', '2020_Q4', '2020-12-31', 'estimated_or_approved', 1576050.8583511997), ('a49c96f347f61cf22722ac2acff59871', 'C2', 'Remanentes de Transferencias Federales Etiquetadas aplicados en el periodo', '2020_Q4', '2020-12-31', 'estimated_or_approved', 560676.5410499998), ('8b1748bf4bdada659bd2496ff6a31ef0', 'E1', 'Intereses, Comisiones y Gastos de la Deuda con Gasto No Etiquetado', '2020_Q4', '2020-12-31', 'estimated_or_approved', 4803603.3892)  ... displaying 10 of 702 total bound parameter sets ...  ('f69388feb0e98f140f57908ff0fec275', 'G1', 'Amortización de la Deuda Pública con Gasto No Etiquetado', '2025_Q1', '2025-03-31', 'recaudado_pagado', 2723846569.49), ('84dc1024b8a7f03d447c3d860e694cc5', 'G2', 'Amortización de la Deuda Pública con Gasto Etiquetado', '2025_Q1', '2025-03-31', 'recaudado_pagado', 6362444.86)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
